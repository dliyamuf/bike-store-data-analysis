# **BIKE STORE DATA ANALYSIS**
## **PROJECT OVERVIEW**
Healthy lifestyle is one of most important things. With many sport and healthy communities, the demand of sport facilities also increasing. One of the most favorite sport is bicycling. From younger until old ones ...

## **DATASET**
The dataset used is [BikeStore](https://www.kaggle.com/datasets/dillonmyrick/bike-store-sample-database) from Kaggle which comprise of 9 csv files:
- brands:
- categories:
- customers:
- order_items:
- orders:
- products:
- staffs:
- stocks:
- stores:

## **DATABASE SETUP**
### **SCHEMA DIAGRAM**
I used snowflake schema to define relationship between tables. I split into two parts: sales and production.
[gambar]

### **CREATE DATABASE**
```sql
CREATE DATABASE bikestore_db;
USE bikestore_db;
```
### **CREATE AND LOAD TABLES**
Tables comprises of sales_customers, sales_order_items, sales_orders, sales_staffs, production_brands, production_categories, production_product, production_stocks, and production_stores.
```sql
CREATE TABLE sales_customers(
customer_id INT PRIMARY KEY,
first_name VARCHAR(30),
last_name VARCHAR(30),
phone VARCHAR(20),
email VARCHAR(50),
street VARCHAR(50),
city VARCHAR(25),
state VARCHAR(25),
zip_code VARCHAR(10)
);
```
Then, load the data of tables from csv files.
```sql
-- load data table sales_customers
LOAD DATA INFILE 'C:\Users\hp\Downloads\bikestore\customers.csv'
INTO TABLE sales_customers
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;
```

## **SQL QUERIES**
### **ORDER AND SALES ANALYSIS**
- **What's total revenue of all bike stores each year?**
```sql
-- creating new table named total_price
ALTER TABLE sales_order_items
ADD total_price FLOAT;
UPDATE sales_order_items
SET total_price = (quantity*list_price - (1-list_price*discount));

-- total revenue per year
SELECT 
YEAR(o.order_date) AS order_year,
SUM(i.total_price) AS total_revenue
FROM sales_orders AS o
JOIN sales_order_items AS i
ON o.order_id = i.order_id
GROUP BY
YEAR(o.order_date)
ORDER BY
YEAR(o.order_date) DESC;

-- alternative solution for Q1 without creating new column
WITH total_order_data AS (
SELECT 
order_id, 
quantity, 
list_price, 
discount,
(quantity* list_price - (1-list_price*discount)) AS total_price
FROM sales_order_items
)
SELECT 
YEAR(o.order_date) AS order_year,
SUM(i.total_price) AS total_revenue
FROM sales_orders AS o
JOIN total_order_data AS i
ON o.order_id = i.order_id
GROUP BY
YEAR(o.order_date)
ORDER BY
YEAR(o.order_date);
```
Insight: The highest revenue is on 2017, the trend shows total revenue is fluctuative with 2018 has lowest revenue.

- **What's total revenue per month?**
```sql
SELECT 
 YEAR(o.order_date) AS order_year,
 MONTH(o.order_date) AS order_month,
 SUM(i.total_price) AS total_revenue
 FROM sales_orders AS o
 JOIN sales_order_items AS i
 ON o.order_id = i.order_id 
 GROUP BY YEAR(o.order_date), MONTH(o.order_date)
ORDER BY YEAR(o.order_date), MONTH(o.order_date);
```
Insight: The highest revenue is on April 2018.

- **How much total revenue each month across product category?**
```sql
SELECT 
 c.category_name,
 YEAR(o.order_date) AS order_year,
 MONTH(o.order_date) AS order_month,
 SUM(i.total_price) AS total_revenue
 FROM sales_orders AS o
 JOIN sales_order_items AS i
 ON o.order_id = i.order_id 
 JOIN production_product AS p
 ON i.product_id = p.product_id
 JOIN production_categories AS c
 ON p.category_id = c.category_id
 GROUP BY c.category_name, YEAR(o.order_date), MONTH(o.order_date)
 ORDER BY YEAR(o.order_date), MONTH(o.order_date);
```
Insight: The highest revenue is generated by road bikes at April 2018.

- **How much total unit sold each year?**
```sql
SELECT 
YEAR(o.order_date) AS order_year,
SUM(i.quantity) AS total_unit
FROM sales_orders AS o
JOIN sales_order_items AS i
ON o.order_id = i.order_id
GROUP BY YEAR(o.order_date)
ORDER BY YEAR(o.order_date);
```
Insight: Most unit sold happened in 2017

### **STORES ANALYSIS**
- **What's total revenue per stores?**
```sql
SELECT  
s.store_name,
SUM(i.total_price) AS total_revenue
FROM sales_orders AS o
JOIN production_stores AS s
ON o.store_id = s.store_id
JOIN sales_order_items AS i
ON o.order_id = i.order_id
GROUP BY s.store_name
ORDER BY SUM(i.total_price) DESC;
```
Insight: Baldwin Bikes store generated highest total revenue.

- **How much total revenue per store each year?**
```sql
SELECT  
s.store_name,
SUM(i.total_price) AS total_revenue,
YEAR(o.order_date) AS order_year
FROM sales_orders AS o
JOIN production_stores AS s
ON o.store_id = s.store_id
JOIN sales_order_items AS i
ON o.order_id = i.order_id
GROUP BY s.store_name, YEAR(o.order_date)
ORDER BY YEAR(o.order_date);
```
Insight: The highest total revenue happened on Baldwin Bikes in 2017.

- **How much is total order per store?**
```sql
SELECT 
s.store_name,
COUNT(o.store_id) AS total_units
FROM sales_orders AS o
JOIN production_stores AS s
ON o.store_id = s.store_id
GROUP BY s.store_id
ORDER BY COUNT(o.store_id) DESC;
```
Insight: Baldwin Bikes store is the store that sold most units.
